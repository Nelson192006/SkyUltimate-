<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SkyUltimate — Home</title>
  <style>
    :root{
      --brand-red:#B00000;
      --brand-red-dark:#900000;
      --card-bg: rgba(255,255,255,0.98);
      --muted:#666;
      --shadow: 0 12px 34px rgba(0,0,0,0.18);
      --radius-lg:20px;
      --radius-md:12px;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0}
    body{
      background:var(--brand-red);
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      -webkit-font-smoothing:antialiased;
      display:flex; align-items:flex-start; justify-content:center; padding:28px;
      color:#111;
    }

    /* page layout */
    .wrap{ width:min(1100px,96vw); display:grid; grid-template-columns: 300px 1fr; gap:22px; align-items:start; }
    @media (max-width:920px){ .wrap{ grid-template-columns: 1fr; } }

    /* left column */
    .panel { background:var(--card-bg); border-radius:var(--radius-lg); box-shadow:var(--shadow); padding:18px; }
    .profile-top{ display:flex; align-items:center; gap:12px; }
    .logo{
      width:88px; height:88px; border-radius:9999px; object-fit:cover;
      flex-shrink:0; box-shadow:0 10px 30px rgba(0,0,0,0.18);
      border:4px solid rgba(255,255,255,0.6);
    }
    .greet { font-size:18px; font-weight:800; }
    .small { color:var(--muted); font-size:13px; margin-top:4px; }

    .role-badge { margin-left:auto; background:var(--brand-red-dark); color:#fff; padding:6px 10px; border-radius:14px; font-weight:700; font-size:13px; }

    .info { margin-top:14px; display:grid; gap:8px; }
    .info .row { display:flex; justify-content:space-between; font-size:14px; color:#333; }
    .actions { display:flex; gap:8px; margin-top:14px; flex-wrap:wrap; }

    .btn {
      background:#fff; border-radius:14px; padding:10px 14px; font-weight:800; border:none;
      box-shadow:0 8px 22px rgba(0,0,0,0.08); cursor:pointer;
    }
    .btn.primary{ background:var(--brand-red); color:#fff; }
    .btn.ghost{ background:transparent; color:#111; border:1px solid rgba(0,0,0,0.06); }

    /* right column header */
    .header {
      display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:12px;
    }
    .brand { color:white; font-weight:900; font-size:20px; letter-spacing:0.4px; }
    .nav-actions { display:flex; gap:8px; align-items:center; }

    /* hamburger for mobile */
    .hamburger { display:none; background:transparent; border:none; color:white; font-size:20px; cursor:pointer; }
    @media (max-width:920px){ .hamburger{ display:block } .nav-actions{ display:none } }

    /* main content cards */
    .content { display:grid; gap:12px; }
    .card { background:var(--card-bg); border-radius:16px; padding:14px; box-shadow:var(--shadow); }
    .card-row { display:flex; gap:12px; align-items:center; justify-content:space-between; flex-wrap:wrap; }

    .summary-grid { display:grid; grid-template-columns: repeat(2,1fr); gap:12px; margin-top:10px; }
    @media (max-width:520px){ .summary-grid{ grid-template-columns: 1fr } }

    .summary { padding:12px; border-radius:12px; background:white; box-shadow:0 8px 20px rgba(0,0,0,0.06); }
    .summary .title{ color:var(--muted); font-size:13px }
    .summary .value{ font-weight:800; font-size:20px; margin-top:6px }

    /* mission/vision, about */
    .section-title{ font-weight:800; margin-bottom:8px; font-size:16px }
    .muted { color:var(--muted); font-size:14px; line-height:1.5 }

    /* FAQ */
    .faq .q{ cursor:pointer; padding:10px; display:flex; justify-content:space-between; align-items:center; border-bottom:1px solid #f0f0f0; }
    .faq .a{ padding:10px; color:var(--muted); display:none; }
    .faq .q.open + .a{ display:block; }

    /* footer */
    .footer { margin-top:14px; display:flex; justify-content:space-between; align-items:center; gap:8px; color:var(--muted); font-size:13px; }

    /* small niceties */
    .pill { display:inline-block; padding:6px 10px; border-radius:999px; background:#f7f7f7; font-weight:700 }
  </style>
</head>
<body>
  <div class="wrap">

    <!-- LEFT: Profile panel -->
    <aside class="panel" id="left-panel">
      <div class="profile-top">
        <img id="profile-logo" class="logo" src="https://github.com/Nelson192006/SkyUltimate-/blob/62343ff3e5e556aa02ecece40e2c006fa9161c0a/logo.png?raw=true" alt="SkyUltimate logo">
        <div>
          <div id="greeting" class="greet">Welcome, User</div>
          <div id="sub" class="small">Deliveries | Payouts | Ratings</div>
        </div>
        <div id="roleBadge" class="role-badge">Customer</div>
      </div>

      <div class="info" style="margin-top:12px;">
        <div class="row"><span>Full name</span><span id="info-name">—</span></div>
        <div class="row"><span>Email</span><span id="info-email">—</span></div>
        <div class="row"><span>Phone</span><span id="info-phone">—</span></div>
      </div>

      <div class="actions" style="margin-top:14px;">
        <button id="btn-dashboard" class="btn primary">Go to Dashboard</button>
        <button id="btn-logout" class="btn">Logout</button>
      </div>

      <div style="margin-top:12px; display:flex; gap:8px;">
        <div class="pill">Safe · Reliable</div>
        <div class="pill">Fast</div>
      </div>
    </aside>

    <!-- RIGHT: content -->
    <main>
      <div class="header">
        <div style="display:flex; align-items:center; gap:12px;">
          <button class="hamburger" id="hambBtn" aria-label="open menu">☰</button>
          <div class="brand">SkyUltimate</div>
        </div>
        <div class="nav-actions">
          <button id="btn-announcements" class="btn ghost">Announcements</button>
          <button id="btn-profile" class="btn ghost">Profile</button>
        </div>
      </div>

      <div class="content">
        <!-- quick actions -->
        <div class="card">
          <div style="display:flex; justify-content:space-between; align-items:center;">
            <div>
              <div style="font-weight:900; font-size:18px">Quick Actions</div>
              <div class="muted" style="margin-top:6px">Go to role-specific areas or create orders quickly.</div>
            </div>
            <div style="display:flex; gap:8px;">
              <button id="btn-create-order" class="btn primary">Create Order</button>
              <button id="btn-my-orders" class="btn">My Orders</button>
            </div>
          </div>

          <div class="summary-grid">
            <div class="summary">
              <div class="title">Pending Payout</div>
              <div class="value" id="pending-payout">₦0</div>
            </div>
            <div class="summary">
              <div class="title">Completed Orders</div>
              <div class="value" id="completed-orders">0</div>
            </div>
            <div class="summary">
              <div class="title">Rating</div>
              <div class="value" id="rating">—</div>
            </div>
            <div class="summary">
              <div class="title">Account Status</div>
              <div class="value" id="account-status">Active</div>
            </div>
          </div>
        </div>

        <!-- mission & vision -->
        <div class="card">
          <div class="section-title">Our Mission</div>
          <div class="muted">Our mission at SkyUltimate Delivery Service is to provide a seamless, reliable, and efficient delivery experience that exceeds our customers' expectations. We are committed to leveraging innovative technology and exceptional customer service to simplify logistics for businesses and individuals alike. We strive to be the most trusted and preferred delivery service, one package at a time.</div>

          <hr style="margin:12px 0; border:none; border-top:1px solid #f2f2f2">

          <div class="section-title">Our Vision</div>
          <div class="muted">To be the industry leader in delivery services, known for our speed, reliability, and unwavering commitment to customer satisfaction. We envision a future where SkyUltimate Delivery Service is synonymous with excellence, setting the standard for logistics solutions and positively impacting the communities we serve.</div>
        </div>

        <!-- about & FAQ -->
        <div class="card">
          <div class="section-title">About</div>
          <div class="muted" style="margin-bottom:12px">
            Welcome to SkyUltimate Delivery Service, where we're dedicated to taking your delivery experience to new heights! Founded in 2024, our company was born from a simple idea: to create a delivery service that's not just fast and reliable, but also puts the customer first. We understand the importance of your packages, whether it's a crucial document for your business or a thoughtful gift for a loved one.
          </div>

          <div class="section-title" style="margin-top:8px">FAQ</div>
          <div class="faq" id="faq">
            <div class="q">How do I track my package? <span>▸</span></div>
            <div class="a">Use your tracking number on our tracking page for real-time updates.</div>

            <div class="q">What are your delivery hours? <span>▸</span></div>
            <div class="a">9:00 AM to 6:00 PM, Monday–Saturday. Contact support for urgent after-hours.</div>

            <div class="q">What items can you deliver? <span>▸</span></div>
            <div class="a">Documents, parcels, general goods. No hazardous/illegal items or live animals.</div>

            <div class="q">What if my package is lost or damaged? <span>▸</span></div>
            <div class="a">Contact support immediately. We will investigate and work on a solution.</div>

            <div class="q">How can I contact support? <span>▸</span></div>
            <div class="a">Phone, email, or live chat on the website (see Contact Us page).</div>
          </div>
        </div>

        <div class="footer card">
          <div>© SkyUltimate</div>
          <div class="muted">Logged in via your SkyUltimate account</div>
        </div>
      </div>
    </main>
  </div>

<script>
  // API base — matches your deployed backend
  const API_BASE = "https://skyultimate-backend-api-structure.onrender.com";
  const PROFILE_PATH = "/api/users/profile";

  // util: get token
  function getToken(){ return localStorage.getItem("su_token") || localStorage.getItem("token"); }

  // first name helper
  function firstName(full){
    if(!full) return "";
    return String(full).split(" ").filter(Boolean)[0] || full;
  }

  // populate UI from localStorage then refresh from API
  async function init(){
    const stored = localStorage.getItem("su_user") || localStorage.getItem("user");
    if (!stored && !getToken()){
      // not logged in
      window.location.href = "index.html";
      return;
    }

    // use stored user immediately to avoid flicker
    let user = stored ? JSON.parse(stored) : null;
    if (user) populateUser(user);

    // refresh from backend if token
    const token = getToken();
    if (token){
      try {
        const res = await fetch(API_BASE + PROFILE_PATH, {
          headers: { "Content-Type":"application/json", "Authorization":"Bearer " + token }
        });
        if (res.ok){
          const profile = await res.json();
          if (profile && profile._id){
            localStorage.setItem("su_user", JSON.stringify(profile));
            populateUser(profile);
          }
        } else {
          // silently ignore profile refresh failures (token might be invalid)
          console.warn("Profile fetch failed", res.status);
        }
      } catch (e){
        console.warn("Profile fetch error", e);
      }
    }
  }

  function populateUser(user){
    document.getElementById("greeting").textContent = `Welcome, ${firstName(user.name)}!`;
    document.getElementById("info-name").textContent = user.name || "—";
    document.getElementById("info-email").textContent = user.email || "—";
    document.getElementById("info-phone").textContent = user.phone || "—";
    document.getElementById("roleBadge").textContent = user.role || "Customer";
    document.getElementById("pending-payout").textContent = "₦" + (user.pendingPayout || 0);
    document.getElementById("completed-orders").textContent = user.completedOrders || 0;
    document.getElementById("rating").textContent = (user.ratingAverage !== undefined ? (Number(user.ratingAverage).toFixed ? Number(user.ratingAverage).toFixed(1) : user.ratingAverage) : "—");
    document.getElementById("account-status").textContent = user.isSuspended ? "Suspended" : "Active";
  }

  // FAQ toggle
  document.querySelectorAll('#faq .q').forEach(q => {
    q.addEventListener('click', () => {
      const open = q.classList.contains('open');
      // close all
      document.querySelectorAll('#faq .q').forEach(x => x.classList.remove('open'));
      document.querySelectorAll('#faq .a').forEach(a => a.style.display = 'none');
      if (!open) {
        q.classList.add('open');
        q.nextElementSibling.style.display = 'block';
      }
    });
  });

  // hamburger toggles visibility of left panel on small screens
  document.getElementById('hambBtn').addEventListener('click', () => {
    const left = document.getElementById('left-panel');
    if (left.style.display === 'none' || getComputedStyle(left).display === 'none') {
      left.style.display = 'block';
      left.style.position = 'absolute';
      left.style.zIndex = 999;
      left.style.left = '12px';
      left.style.top = '80px';
      left.style.width = '86%';
    } else {
      left.style.display = 'none';
      left.style.position = '';
      left.style.zIndex = '';
      left.style.left = '';
      left.style.top = '';
      left.style.width = '';
    }
  });

  // navigation buttons
  document.getElementById('btn-logout').addEventListener('click', () => {
    localStorage.removeItem('su_token');
    localStorage.removeItem('token');
    localStorage.removeItem('su_user');
    localStorage.removeItem('user');
    window.location.href = 'index.html';
  });

  document.getElementById('btn-dashboard').addEventListener('click', () => {
    const user = JSON.parse(localStorage.getItem('su_user') || localStorage.getItem('user') || '{}');
    const role = (user.role || '').toLowerCase();
    if (role === 'superadmin' || role === 'super-admin') window.location.href = 'superadmin-dashboard.html';
    else if (role === 'admin') window.location.href = 'admin-dashboard.html';
    else if (role === 'agent') window.location.href = 'agent-dashboard.html';
    else window.location.href = 'customer-dashboard.html';
  });

  document.getElementById('btn-create-order').addEventListener('click', () => window.location.href = 'create-order.html');
  document.getElementById('btn-my-orders').addEventListener('click', () => window.location.href = 'orders.html');
  document.getElementById('btn-announcements').addEventListener('click', () => window.location.href = 'announcements.html');
  document.getElementById('btn-profile').addEventListener('click', () => window.location.href = 'profile.html');

  // start
  init();
</script>
</body>
</html>
