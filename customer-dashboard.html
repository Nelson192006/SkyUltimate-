<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Customer Dashboard</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; font-family: Arial, sans-serif; }
  body, html { min-height: 100vh; background-color: #C00000; color: white; }
  #container { padding: 20px; max-width: 800px; margin: auto; }
  #logo { width: 140px; height: 140px; border-radius: 50%; display: block; margin: 20px auto; }
  h2 { text-align: center; margin-bottom: 20px; }

  /* Order Card */
  .card { background: rgba(255,255,255,0.95); color: #C00000; border-radius: 12px; padding: 20px; margin-bottom: 20px; }
  .form-group { margin-bottom: 15px; }
  input, select { width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #ccc; }

  button {
    width: 100%;
    padding: 12px;
    border: none;
    border-radius: 8px;
    background-color: #C00000;
    color: white;
    font-size: 16px;
    cursor: pointer;
    margin-top: 10px;
  }
  button:disabled { background-color: grey; cursor: not-allowed; }

  /* Hamburger menu */
  #hamburger { position: absolute; top: 20px; left: 20px; font-size: 30px; cursor: pointer; }
  #side-menu { position: fixed; top: 0; left: -250px; width: 250px; height: 100%; background: #fff; color: #C00000;
    box-shadow: 3px 0 10px rgba(0,0,0,0.3); transition: 0.3s; padding-top: 60px; z-index: 100; }
  #side-menu a { display: block; padding: 15px 20px; text-decoration: none; color: #C00000; font-weight: bold; }
  #side-menu a:hover { background: #f0f0f0; }

  /* Modal */
  .modal { display: none; position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.85); z-index:200;
    color:white; justify-content:center; align-items:center; padding:20px; }
  .modal-content { background:white; color:#C00000; padding:20px; border-radius:10px; max-width:400px; width:100%; }
  .modal-content h3 { margin-bottom: 15px; }
  .modal-content button { margin-top: 10px; }

</style>
</head>
<body>

<div id="hamburger">&#9776;</div>
<div id="side-menu">
  <a href="#" onclick="showOverlay('rate-agent')">Rate Agent</a>
  <a href="#" onclick="showOverlay('report-agent')">Report Agent</a>
  <a href="#" onclick="logout()">Logout</a>
</div>

<div id="container">
  <img id="logo" src="https://raw.githubusercontent.com/Nelson192006/SkyUltimate-/fdf409b0e40dfbd432afd277b20ddb8965600fc7/logo.png" alt="Logo">
  <h2>Place a New Order</h2>

  <div class="card">
    <div class="form-group">
      <select id="item-type">
        <option value="">Select Item Type</option>
        <option value="Document">Document</option>
        <option value="Parcel">Parcel</option>
        <option value="General Goods">General Goods</option>
      </select>
    </div>
    <div class="form-group">
      <input type="number" id="weight" placeholder="Weight (kg)">
    </div>
    <div class="form-group">
      <input type="text" id="pickup" placeholder="Pickup Address">
    </div>
    <div class="form-group">
      <input type="text" id="delivery" placeholder="Delivery Address">
    </div>
    <button id="calculate-btn" disabled onclick="calculatePrice()">Calculate Final Price</button>
  </div>
</div>

<!-- Price Modal -->
<div id="price-modal" class="modal">
  <div class="modal-content">
    <h3>Order Summary</h3>
    <p id="price-info"></p>
    <p><strong>Bank Details:</strong></p>
    <select id="bank-selection">
      <option value="Moniepoint">Moniepoint - 9128884830</option>
      <option value="Opay">Opay - 9128884830</option>
      <option value="Palmpay">Palmpay - 9128884830</option>
      <option value="UBA">UBA - 2342835397</option>
      <option value="GTBank">GTBank - 0734090626</option>
    </select>
    <p>Account Name: Nelson Emmanuel Godspower</p>
    <button onclick="closeModal('price-modal')">Close</button>
  </div>
</div>

<!-- Rate Agent Overlay -->
<div id="rate-agent" class="modal">
  <div class="modal-content">
    <h3>Rate Agent</h3>
    <p>Rate your agent after completing an order:</p>
    <select id="star-rating">
      <option value="1">⭐</option>
      <option value="2">⭐⭐</option>
      <option value="3">⭐⭐⭐</option>
      <option value="4">⭐⭐⭐⭐</option>
      <option value="5">⭐⭐⭐⭐⭐</option>
    </select>
    <textarea id="rating-comment" placeholder="Comment (optional)" style="width:100%;margin-top:10px;"></textarea>
    <button onclick="submitRating()">Submit Rating</button>
    <button onclick="closeModal('rate-agent')">Close</button>
  </div>
</div>

<!-- Report Agent Overlay -->
<div id="report-agent" class="modal">
  <div class="modal-content">
    <h3>Report Agent</h3>
    <textarea id="report-comment" placeholder="Describe the issue" style="width:100%;margin-top:10px;"></textarea>
    <button onclick="submitReport()">Submit Report</button>
    <button onclick="closeModal('report-agent')">Close</button>
  </div>
</div>

<script>
  // Hamburger toggle
  const hamburger = document.getElementById('hamburger');
  const sideMenu = document.getElementById('side-menu');
  let menuOpen = false;
  hamburger.onclick = () => {
    sideMenu.style.left = menuOpen ? '-250px' : '0';
    menuOpen = !menuOpen;
  };

  // Enable calculate button when fields filled
  const fields = ['item-type','weight','pickup','delivery'];
  fields.forEach(id => {
    document.getElementById(id).addEventListener('input', checkFields);
  });
  function checkFields() {
    const filled = fields.every(id => document.getElementById(id).value);
    document.getElementById('calculate-btn').disabled = !filled;
  }

  // API Base
  const API_BASE = 'https://skyultimate-backend-api-structure.onrender.com';

  // Calculate price
  async function calculatePrice() {
    const payload = {
      itemType: document.getElementById('item-type').value,
      weight: document.getElementById('weight').value,
      pickup: document.getElementById('pickup').value,
      delivery: document.getElementById('delivery').value
    };
    try {
      const token = sessionStorage.getItem('token');
      const res = await fetch(`${API_BASE}/orders/calculate`, {
        method: 'POST',
        headers: {'Content-Type':'application/json','Authorization':`Bearer ${token}`},
        body: JSON.stringify(payload)
      });
      const data = await res.json();
      if(res.ok){
        document.getElementById('price-info').innerHTML = `Final Price: ₦${data.finalPrice}`;
        document.getElementById('price-modal').style.display = 'flex';
      } else { alert(data.message || 'Error calculating price'); }
    } catch(err){ alert('Server error'); }
  }

  function closeModal(id){ document.getElementById(id).style.display='none'; }

  // Placeholder rating/report submissions
  function submitRating(){ alert('Rating submitted (API integration pending)'); closeModal('rate-agent'); }
  function submitReport(){ alert('Report submitted (API integration pending)'); closeModal('report-agent'); }

  // Logout
  function logout(){
    sessionStorage.clear();
    window.location.href = 'home.html';
  }
</script>

</body>
  </html>
